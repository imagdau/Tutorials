Inspired from https://github.com/ilyes319/mace-tutorials/blob/main/mace-devs/MACE_developer.ipynb
